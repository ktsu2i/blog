---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCareer } from "../../data/career";
import { Briefcase, GraduationCap, Building2 } from "lucide-react";
import {
  type Locale,
  defaultLocale,
  useTranslations,
} from "../../i18n/config";

const locale = (Astro.currentLocale ?? defaultLocale) as Locale;
const t = useTranslations(locale);
const career = getCareer(locale);

const typeConfig = {
  work: { label: t["about.type.work"], color: "bg-blue-500/15 text-blue-700 dark:text-blue-300 border-blue-500/20" },
  internship: { label: t["about.type.internship"], color: "bg-amber-500/15 text-amber-700 dark:text-amber-300 border-amber-500/20" },
  education: { label: t["about.type.education"], color: "bg-emerald-500/15 text-emerald-700 dark:text-emerald-300 border-emerald-500/20" },
};
---

<BaseLayout title={t["about.title"]} description={t["about.description"]}>
  <div class="space-y-12">
    <div>
      <h1 class="text-3xl font-bold tracking-tight">{t["about.title"]}</h1>
    </div>

    <div class="flex flex-col items-start gap-8 sm:flex-row">
      <img src="/images/avatar.png" alt="筒井海人 Kaito Tsutsui" class="size-32 shrink-0 rounded-full bg-muted object-cover" />
      <div class="space-y-4">
        <h2 class="text-xl font-semibold">
          {locale === "ja"
            ? <>筒井 海人 <span class="text-sm font-normal text-muted-foreground">Kaito Tsutsui</span></>
            : "Kaito Tsutsui"}
        </h2>
        <p class="leading-relaxed text-muted-foreground">
          {t["about.bio"]}
        </p>
      </div>
    </div>

    <section>
      <div class="grid gap-3 sm:grid-cols-3">
        <!-- GitHub -->
        <a
          href="https://github.com/ktsu2i"
          target="_blank"
          rel="noopener noreferrer"
          class="group flex items-center gap-4 rounded-xl border bg-card p-4 transition-all duration-200 hover:-translate-y-0.5 hover:border-foreground/25 hover:shadow-md"
        >
          <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-[#24292f] dark:bg-[#f0f6fc] text-white dark:text-[#24292f]">
            <svg viewBox="0 0 24 24" class="size-5 fill-current" aria-hidden="true">
              <path d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0 1 12 6.844a9.59 9.59 0 0 1 2.504.337c1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.02 10.02 0 0 0 22 12.017C22 6.484 17.522 2 12 2Z" />
            </svg>
          </div>
          <div class="min-w-0 flex-1">
            <span class="text-sm font-semibold">GitHub</span>
            <span class="block text-xs text-muted-foreground">@ktsu2i</span>
          </div>
          <svg viewBox="0 0 24 24" class="size-4 shrink-0 text-muted-foreground transition-transform duration-200 group-hover:translate-x-0.5 group-hover:-translate-y-0.5 group-hover:text-foreground" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M7 17L17 7M17 7H7M17 7V17" />
          </svg>
        </a>

        <!-- X -->
        <a
          href="https://x.com/ktsu2i"
          target="_blank"
          rel="noopener noreferrer"
          class="group flex items-center gap-4 rounded-xl border bg-card p-4 transition-all duration-200 hover:-translate-y-0.5 hover:border-foreground/25 hover:shadow-md"
        >
          <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-[#0f1419] dark:bg-[#e7e9ea] text-white dark:text-[#0f1419]">
            <svg viewBox="0 0 24 24" class="size-4 fill-current" aria-hidden="true">
              <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
            </svg>
          </div>
          <div class="min-w-0 flex-1">
            <span class="text-sm font-semibold">X</span>
            <span class="block text-xs text-muted-foreground">@ktsu2i</span>
          </div>
          <svg viewBox="0 0 24 24" class="size-4 shrink-0 text-muted-foreground transition-transform duration-200 group-hover:translate-x-0.5 group-hover:-translate-y-0.5 group-hover:text-foreground" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M7 17L17 7M17 7H7M17 7V17" />
          </svg>
        </a>

        <!-- LinkedIn -->
        <a
          href="https://www.linkedin.com/in/ktsu2i"
          target="_blank"
          rel="noopener noreferrer"
          class="group flex items-center gap-4 rounded-xl border bg-card p-4 transition-all duration-200 hover:-translate-y-0.5 hover:border-foreground/25 hover:shadow-md"
        >
          <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-[#0a66c2] text-white">
            <svg viewBox="0 0 24 24" class="size-5 fill-current" aria-hidden="true">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
            </svg>
          </div>
          <div class="min-w-0 flex-1">
            <span class="text-sm font-semibold">LinkedIn</span>
            <span class="block text-xs text-muted-foreground">ktsu2i</span>
          </div>
          <svg viewBox="0 0 24 24" class="size-4 shrink-0 text-muted-foreground transition-transform duration-200 group-hover:translate-x-0.5 group-hover:-translate-y-0.5 group-hover:text-foreground" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M7 17L17 7M17 7H7M17 7V17" />
          </svg>
        </a>
      </div>
    </section>

    <!-- Career Timeline -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">{t["about.career"]}</h2>

      <div class="relative">
        <!-- Vertical line -->
        <div class="absolute left-4.75 top-0 bottom-0 w-px bg-linear-to-b from-border via-border to-transparent"></div>

        <div class="space-y-0">
          {career.map((entry) => {
            const type = entry.type || "work";
            const config = typeConfig[type];

            return (
              <div class="relative flex gap-6 pb-10 last:pb-0">
                <!-- Timeline node -->
                <div class="relative z-10 flex shrink-0 items-start pt-1">
                  <div class:list={[
                    "flex size-10 items-center justify-center rounded-full border-2",
                    entry.current
                      ? "border-foreground bg-foreground text-background shadow-[0_0_0_4px] shadow-foreground/10"
                      : "border-border bg-background text-muted-foreground",
                  ]}>
                    {type === "work" && <Briefcase className="size-4" />}
                    {type === "internship" && <Building2 className="size-4" />}
                    {type === "education" && <GraduationCap className="size-4" />}
                  </div>
                </div>

                <!-- Content card -->
                <div class:list={[
                  "min-w-0 flex-1 rounded-xl border bg-card p-5",
                  entry.current && "border-foreground/15 shadow-sm",
                ]}>
                  <!-- Top row: period + type badge -->
                  <div class="flex flex-wrap items-center gap-2 mb-2">
                    <span class="text-sm font-medium text-muted-foreground">
                      {entry.period}
                    </span>
                    {entry.current && (
                      <span class="inline-flex items-center gap-1 rounded-full bg-foreground/10 px-2 py-0.5 text-xs font-medium text-foreground">
                        <span class="size-1.5 rounded-full bg-emerald-500 animate-pulse" />
                        {t["about.current"]}
                      </span>
                    )}
                    {config && (
                      <span class:list={[
                        "inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-medium",
                        config.color,
                      ]}>
                        {config.label}
                      </span>
                    )}
                  </div>

                  <!-- Title & subtitle -->
                  <h3 class="text-lg font-semibold tracking-tight">{entry.type === "education" ? entry.university : entry.role}</h3>
                  <p class="mt-0.5 text-sm text-muted-foreground">{entry.type === "education" ? entry.major : entry.company}</p>

                  <!-- Description -->
                  {entry.description && (
                    <p class="mt-3 text-sm leading-relaxed text-muted-foreground">
                      {entry.description}
                    </p>
                  )}

                  <!-- Tags -->
                  {entry.tags && entry.tags.length > 0 && (
                    <div class="mt-3 flex flex-wrap gap-1.5">
                      {entry.tags.map((tag) => (
                        <span class="inline-flex items-center rounded-md bg-secondary px-2 py-0.5 text-xs font-medium text-secondary-foreground">
                          {tag}
                        </span>
                      ))}
                    </div>
                  )}
                </div>
              </div>
            );
          })}
        </div>
      </div>
    </section>
  </div>
</BaseLayout>
