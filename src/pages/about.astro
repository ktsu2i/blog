---
import BaseLayout from "../layouts/BaseLayout.astro";
import { career } from "../data/career";
import { Briefcase, GraduationCap, Building2 } from "lucide-react";

const techStack = [
  "TypeScript",
  "Go",
  "React",
  "Astro",
  "Tailwind CSS",
  "Node.js",
  "PostgreSQL",
  "Docker",
  "Git",
];

const typeConfig = {
  work: { label: "正社員", color: "bg-blue-500/15 text-blue-700 dark:text-blue-300 border-blue-500/20" },
  internship: { label: "インターン", color: "bg-amber-500/15 text-amber-700 dark:text-amber-300 border-amber-500/20" },
  education: { label: "学歴", color: "bg-emerald-500/15 text-emerald-700 dark:text-emerald-300 border-emerald-500/20" },
};
---

<BaseLayout title="About" description="自己紹介">
  <div class="space-y-12">
    <div>
      <h1 class="text-3xl font-bold tracking-tight">About</h1>
    </div>

    <div class="flex flex-col items-start gap-8 sm:flex-row">
      <div class="size-32 shrink-0 rounded-full bg-muted"></div>
      <div class="space-y-4">
        <h2 class="text-xl font-semibold">ktsu2i</h2>
        <p class="leading-relaxed text-muted-foreground">
          ソフトウェアエンジニア。Web 開発を中心に活動しています。
          プレースホルダーのテキストです。実際の自己紹介に置き換えてください。
        </p>
      </div>
    </div>

    <section class="space-y-4">
      <h2 class="text-xl font-semibold">Tech Stack</h2>
      <div class="flex flex-wrap gap-2">
        {techStack.map((tech) => (
          <span class="inline-flex items-center justify-center rounded-full bg-secondary text-secondary-foreground px-2 py-0.5 text-xs font-medium">
            {tech}
          </span>
        ))}
      </div>
    </section>

    <!-- Career Timeline -->
    <section class="space-y-4">
      <h2 class="text-xl font-semibold">Career</h2>

      <div class="relative">
        <!-- Vertical line -->
        <div class="absolute left-[19px] top-0 bottom-0 w-px bg-gradient-to-b from-border via-border to-transparent"></div>

        <div class="space-y-0">
          {career.map((entry) => {
            const type = entry.type || "work";
            const config = typeConfig[type];

            return (
              <div class="relative flex gap-6 pb-10 last:pb-0">
                <!-- Timeline node -->
                <div class="relative z-10 flex shrink-0 items-start pt-1">
                  <div class:list={[
                    "flex size-10 items-center justify-center rounded-full border-2",
                    entry.current
                      ? "border-foreground bg-foreground text-background shadow-[0_0_0_4px] shadow-foreground/10"
                      : "border-border bg-background text-muted-foreground",
                  ]}>
                    {type === "work" && <Briefcase className="size-4" />}
                    {type === "internship" && <Building2 className="size-4" />}
                    {type === "education" && <GraduationCap className="size-4" />}
                  </div>
                </div>

                <!-- Content card -->
                <div class:list={[
                  "min-w-0 flex-1 rounded-xl border bg-card p-5",
                  entry.current && "border-foreground/15 shadow-sm",
                ]}>
                  <!-- Top row: period + type badge -->
                  <div class="flex flex-wrap items-center gap-2 mb-2">
                    <span class="text-sm font-medium text-muted-foreground">
                      {entry.period}
                    </span>
                    {entry.current && (
                      <span class="inline-flex items-center gap-1 rounded-full bg-foreground/10 px-2 py-0.5 text-xs font-medium text-foreground">
                        <span class="size-1.5 rounded-full bg-emerald-500 animate-pulse" />
                        現在
                      </span>
                    )}
                    {config && (
                      <span class:list={[
                        "inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-medium",
                        config.color,
                      ]}>
                        {config.label}
                      </span>
                    )}
                  </div>

                  <!-- Title & subtitle -->
                  <h3 class="text-lg font-semibold tracking-tight">{entry.type === "education" ? entry.university : entry.role}</h3>
                  <p class="mt-0.5 text-sm text-muted-foreground">{entry.type === "education" ? entry.major : entry.company}</p>

                  <!-- Description -->
                  {entry.description && (
                    <p class="mt-3 text-sm leading-relaxed text-muted-foreground">
                      {entry.description}
                    </p>
                  )}

                  <!-- Tags -->
                  {entry.tags && entry.tags.length > 0 && (
                    <div class="mt-3 flex flex-wrap gap-1.5">
                      {entry.tags.map((tag) => (
                        <span class="inline-flex items-center rounded-md bg-secondary px-2 py-0.5 text-xs font-medium text-secondary-foreground">
                          {tag}
                        </span>
                      ))}
                    </div>
                  )}
                </div>
              </div>
            );
          })}
        </div>
      </div>
    </section>

    <section class="space-y-4">
      <h2 class="text-xl font-semibold">Links</h2>
      <ul class="space-y-2 text-muted-foreground">
        <li>
          <a
            href="https://github.com/ktsu2i"
            target="_blank"
            rel="noopener noreferrer"
            class="hover:text-foreground transition-colors"
          >
            GitHub
          </a>
        </li>
        <li>
          <a
            href="https://x.com/ktsu2i"
            target="_blank"
            rel="noopener noreferrer"
            class="hover:text-foreground transition-colors"
          >
            X (Twitter)
          </a>
        </li>
        <li>
          <a
            href="https://zenn.dev/ktsu2i"
            target="_blank"
            rel="noopener noreferrer"
            class="hover:text-foreground transition-colors"
          >
            Zenn
          </a>
        </li>
      </ul>
    </section>
  </div>
</BaseLayout>
